<!DOCTYPE html> <!-- Dokumentum típusa -->
<html lang="en"> <!-- Nyelvi beállítás -->
<head>
    <meta charset="UTF-8"> <!-- Karakterkódolás -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- Megjelenítési beállítások -->
    <title>Teso</title> <!-- Oldal címe -->
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <canvas id="gameCanvas" width="1280" height="720"></canvas> 
    <script>
        var canvas, canvasContext; // Vászon és kontextus
        var bulletY = 0, // Lövedék Y poz.
            bulletX = 0; // Lövedék X poz.
        var enemyX = 300, // Ellenség X poz.
            enemyY = 300, // Ellenség Y poz.
            enemyW = 20, // Ellenség szél.
            enemyH = 20, // Ellenség mag.
            enemySpeedX = 0, // Ellenség X seb.
            enemySpeedY = 0; // Ellenség Y seb.
        var playerX = 640, // Játékos X pozíciója
            playerY = 370, // Játékos Y pozíciója
            playerW = 20, // Játékos szélessége
            playerH = 20, // Játékos magassága
            playerSpeedX = 0, // Játékos X tengely menti sebessége
            playerSpeedY = 0; // Játékos Y tengely menti sebessége
        var mouseX = 0, // Egér X pozíciója
            mouseY = 0; // Egér Y pozíciója
        var bullets = []; // Lövedékek tömbje
        var bulletSpeed = 10; // Lövedék sebessége
        var KEY_W = 87, // W billentyű kódja
            KEY_A = 65, // A billentyű kódja
            KEY_S = 83, // S billentyű kódja
            KEY_D = 68; // D billentyű kódja
        var keyHeld_Down = false, // Lefelé billentyű lenyomva
            keyHeld_Up = false, // Felfelé billentyű lenyomva
            keyHeld_Left = false, // Balra billentyű lenyomva
            keyHeld_Right = false, // Jobbra billentyű lenyomva
            keyHeld_Shoot = false; // Lövés billentyű lenyomva
        var canShoot = true; // Lövés engedélyezése
        window.onload = function() {
            // Vászon és kontextus inicializálása
            canvas = document.getElementById('gameCanvas');
            canvasContext = canvas.getContext('2d');
            var framesPerSecond = 60; // Fps beállítása
            // Időzítő beállítása
            setInterval(function() {
                moveEverything(); // Mozgás frissítése
                drawEverything(); // Rajzolás frissítése
            }, 1000 / framesPerSecond);
            // Egér és billentyű eseménykezelők hozzáadása
            canvas.addEventListener('mousemove', updateMousePos);
            canvas.addEventListener('mousedown', mousePressed);
            canvas.addEventListener('mouseup', mouseReleased);
            document.addEventListener('keydown', keyPressed);
            document.addEventListener('keyup', keyReleased);
        }
        function updateMousePos(evt) {
            // Egér pozíció frissítése
            var rect = canvas.getBoundingClientRect();
            var root = document.documentElement;
            mouseX = evt.clientX - rect.left - root.scrollLeft;
            mouseY = evt.clientY - rect.top - root.scrollTop;
        }
        function mousePressed(evt) {
            shootBullet(); // Lövés egérkattintásra
        }
        function mouseReleased(evt) {
            keyHeld_Shoot = false; // Lövés billentyű felengedése
            canShoot = true; // Lövés engedélyezése
        }
        function shootBullet() {
            // Lövedék létrehozása és hozzáadása a tömbhöz
            var bullet = {
                x: playerX,
                y: playerY,
                size: 5,
                vx: (mouseX - playerX) / 5,
                vy: (mouseY - playerY) / 5
            };
            bullets.push(bullet);
        }
        function keyPressed(evt) {
            // Billentyű lenyomás kezelése
            if (evt.keyCode == KEY_A) keyHeld_Left = true;
            if (evt.keyCode == KEY_D) keyHeld_Right = true;
            if (evt.keyCode == KEY_W) keyHeld_Up = true;
            if (evt.keyCode == KEY_S) keyHeld_Down = true;
        }
        function keyReleased(evt) {
            // Billentyű felengedés kezelése
            if (evt.keyCode == KEY_A) {
                keyHeld_Left = false;
                playerSpeedX = 0;
            }
            if (evt.keyCode == KEY_D) {
                keyHeld_Right = false;
                playerSpeedX = 0;
            }
            if (evt.keyCode == KEY_W) {
                keyHeld_Up = false;
                playerSpeedY = 0;
            }
            if (evt.keyCode == KEY_S) {
                keyHeld_Down = false;
                playerSpeedY = 0;
            }
            if (evt.keyCode == KEY_SPACE) {
                keyHeld_Shoot = false;
                canShoot = true; // Lövés engedélyezése billentyű felengedése után
            }
        }
function moveEverything() {
    // Játékos, ellenség mozgatása
    playerX += playerSpeedX;
    playerY += playerSpeedY;
    // enemyX += enemySpeedX; nem releváns
    // enemyY += enemySpeedY; nem releváns
    // Ellenség mozgása és eltűnése 
    if (enemyX && enemyY <= bulletX && bulletY || enemyX && enemyY >= bulletX && bulletY)
        enemyX = Math.random(1000, 600);
    // Játékos mozgásának irányítása és határok ellenőrzése
    if (keyHeld_Up) playerSpeedY = -7;
    if (keyHeld_Down) playerSpeedY = 7;
    if (keyHeld_Left) playerSpeedX = -7;
    if (keyHeld_Right) playerSpeedX = 7;
    if (playerX >= canvas.width - playerW) playerX = canvas.width - playerW;
    if (playerX <= 0) playerX = 0;
    if (playerY <= 0) playerY = 0;
    if (playerY >= canvas.height - playerH) playerY = canvas.height - playerH;
    // Lövedékek mozgatása és határok ellenőrzése
    for (var i = 0; i < bullets.length; i++) {
        var bullet = bullets[i];
        bullet.x += bullet.vx;
        bullet.y += bullet.vy;
    }
    bullets = bullets.filter(function(bullet) {
        return bullet.x >= 0 && bullet.x <= canvas.width && bullet.y >= 0 && bullet.y <= canvas.height;
    });
}
function drawEverything() {
    // Vászon kitöltése feketével
    canvasContext.fillStyle = 'black';
    canvasContext.fillRect(0, 0, canvas.width, canvas.height);
    // Játékos kirajzolása
    canvasContext.fillStyle = 'blue';
    canvasContext.fillRect(playerX, playerY, playerW, playerH);
    // Ellenség kirajzolása
    canvasContext.fillStyle = 'red';
    canvasContext.fillRect(enemyX, enemyY, enemyW, enemyH);
    // Lövedékek kirajzolása
    canvasContext.fillStyle = 'white';
    for (var i = 0; i < bullets.length; i++) {
        var bullet = bullets[i];
        canvasContext.fillRect(bullet.x - bullet.size / 2, bullet.y - bullet.size / 2, bullet.size, bullet.size);
    }
    // Szöveg kirajzolása
    canvasContext.fillStyle = 'grey';
    canvasContext.fillText("Irányítás: W-A-S-D", 10, canvas.height - 10);
    canvasContext.fillText("Varga Dávid", 1215, canvas.height - 27);
    canvasContext.fillText("Bulyáki Máté", 1213, canvas.height - 10);
}
    </script>
</body>
</html>
